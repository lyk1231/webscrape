import requests
from bs4 import BeautifulSoup as bs
import pandas as pd
import csv
from google.colab import files


#grab website
r= requests.get('https://kith.com/collections/sale-all')

soup= bs(r.content)
# print(soup.prettify())


#scrap time
file= open('kithsales.csv', 'w')
writer= csv.writer(file)

#write header names
writer.writerow(['link', 'item name', 'old price', 'new price'])

all_links= soup.find_all('a', 'product-card__link')
all_items = soup.find_all('h1', 'product-card__title')
all_prices = soup.find_all('span', 'product-card__price')

number_of_items= len(all_items)
for x in range(number_of_items):
  link= 'kith.com' + all_links[x]['href']
  item_name= all_items[x].text
  old_price= all_prices[x].get_text().split('$')[1].replace(',', '')
  new_price= all_prices[x].get_text().split('$')[2].replace(',', '')

  writer.writerow([link, item_name, old_price, new_price])

file.close()


#calculate discount
df= pd.read_csv('kithsales.csv')
print(df.dtypes)

df['discount']= 1 - (df['new price']/df['old price'])

df.to_csv('kithsales.csv', sep=',', index=False)

files.download('kithsales.csv') 
